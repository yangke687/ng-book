<!DOCTYPE html>
<html lang="en" ng-app="myApp">
<head>
	<meta charset="UTF-8">
	<title>Angular Service</title>
	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0-rc.3/angular.js"></script>
</head>
<body>
	<div ng-controller="serviceController">
		<label for="username">
			Type in a GitHub username
		</label>
		<input type="text"
			ng-model="username"
			placeholder="Enter a GitHub username" />
		<ul>
			<li ng-repeat="event in events">
				{{ event.actor.login }} {{ event.repo.name }}
			</li>
		</ul>
	</div>
	<script>
		angular.module('myApp',['myApp.services'])
			.controller('serviceController',['$scope','githubService',function($scope,githubService){
				$scope.username = 'yangke687';
				return githubService
					.events($scope.username)
					.then(function(res){
						$scope.events = res.data.data;
					});
			}]);

		angular.module('myApp.services',[])
			.factory('githubService',['$http',function($http){
				var githubUrl = 'http://api.github.com';
				var runUserRequest = function(username,path){
					return $http({
						method: 'JSONP',
						url: githubUrl + '/users/'
							+ username + '/'
							+ path + '?callback=JSON_CALLBACK',
					})
				}
				return {
					events: function(username){
						return runUserRequest(username,'events');
					}
				}
			}]);
	</script>
</body>
</html>